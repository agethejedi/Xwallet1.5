<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RiskXLabs â€” X-Wallet v1.5</title>
  <meta name="theme-color" content="#071016" />
  <link rel="preconnect" href="." />
  <link rel="icon" href="assets/favicon.png" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Optional: fonts (use system stack for speed) -->
</head>

<body>
  <header class="rxl-header">
    <div class="brand">
      <!-- Use your shield+flask mark with transparent background -->
      <img src="assets/riskxlabs-shieldflask.png" alt="RiskXLabs" class="brand-logo" />
      <h1 class="brand-title">Risk<span class="x-accent">X</span>Labs</h1>
    </div>

    <nav class="nav">
      <a href="index.html" class="nav-link active">Home</a>
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="safesend.html" class="nav-link">SafeSend</a>
      <div class="nav-divider" aria-hidden="true"></div>
      <div class="nav-dropdown">
        <button class="nav-link nav-button" id="toolsBtn" aria-expanded="false" aria-controls="toolsMenu">Tools â–¾</button>
        <div id="toolsMenu" class="menu" role="menu" aria-labelledby="toolsBtn">
          <a role="menuitem" href="examiner.html" class="menu-item">Examiner / Eagle Eye</a>
          <a role="menuitem" href="wallet.html" class="menu-item">X-Wallet</a>
          <a role="menuitem" href="settings.html" class="menu-item">Settings</a>
        </div>
      </div>
      <a href="#" id="whatsNewOpen" class="nav-link whats-new">Whatâ€™s New 1.5</a>
    </nav>
  </header>

  <main class="main">
    <section class="hero card">
      <div class="hero-copy">
        <h2 class="hero-title">X-Wallet <span class="pill pill-good">v1.5</span></h2>
        <p class="hero-subtitle">Non-custodial. Multi-chain. Built to <strong>block fraud</strong> before it happens.</p>
        <ul class="hero-points">
          <li>New: <strong>Multi-chain selection</strong> (Ethereum, Base, Polygon, Sepolia, more)</li>
          <li>Expanded risk model: <strong>OFAC hard-block</strong>, <strong>Scam clusters</strong> â‰¥60 baseline, Phishing clusters</li>
          <li>Cleaner hand-off to <code>app.js</code> / Worker via <code>localStorage</code></li>
        </ul>
      </div>
      <div class="hero-cta">
        <button id="enterBtn" class="btn btn-primary">Enter X-Wallet</button>
        <p class="cta-hint">Weâ€™ll remember your selected networks and load them in the app.</p>
      </div>
    </section>

    <section class="card">
      <h3 class="section-title">Select Networks</h3>

      <!-- Quick-pick pills -->
      <div class="net-pills" id="netPills" role="group" aria-label="Quick network select">
        <!-- Use data-id to keep identifiers stable for app.js -->
        <button class="pill pill-select" data-id="ethereum" aria-pressed="true">ðŸŸ£ Ethereum</button>
        <button class="pill pill-select" data-id="base" aria-pressed="true">ðŸŸ¦ Base</button>
        <button class="pill pill-select" data-id="polygon" aria-pressed="true">ðŸŸª Polygon</button>
        <button class="pill pill-select" data-id="sepolia" aria-pressed="true">ðŸŸ¡ Sepolia</button>
        <button class="pill pill-select" data-id="arbitrum" aria-pressed="false">ðŸ”µ Arbitrum</button>
        <button class="pill pill-select" data-id="optimism" aria-pressed="false">ðŸ”´ Optimism</button>
      </div>

      <!-- Select all / none -->
      <div class="net-bulk">
        <button id="selectAll" class="btn btn-ghost">Select All</button>
        <button id="selectNone" class="btn btn-ghost">Clear</button>
      </div>

      <!-- Dropdown fallback -->
      <label class="select-label" for="networkSelect">Or choose from list</label>
      <select class="network-select" id="networkSelect" multiple size="6" aria-describedby="netHelp">
        <option value="ethereum" selected>Ethereum</option>
        <option value="base" selected>Base</option>
        <option value="polygon" selected>Polygon</option>
        <option value="sepolia" selected>Sepolia</option>
        <option value="arbitrum">Arbitrum</option>
        <option value="optimism">Optimism</option>
      </select>
      <p id="netHelp" class="muted">Tip: hold Ctrl/Cmd to select multiple.</p>
    </section>

    <section class="card">
      <h3 class="section-title">Risk Assessment (active in 1.5)</h3>
      <div class="risk-grid">
        <div class="risk-item">
          <span class="risk-dot dot-hard"></span>
          <div>
            <div class="risk-name">OFAC Sanctions</div>
            <div class="risk-note">Hard-block â€” transfers to listed addresses are prevented.</div>
          </div>
        </div>
        <div class="risk-item">
          <span class="risk-dot dot-high"></span>
          <div>
            <div class="risk-name">Scam Clusters</div>
            <div class="risk-note">Presence sets â‰¥ <strong>60</strong> for that factor alone.</div>
          </div>
        </div>
        <div class="risk-item">
          <span class="risk-dot dot-med"></span>
          <div>
            <div class="risk-name">Phishing Clusters</div>
            <div class="risk-note">Known phishing campaigns & look-alike routes.</div>
          </div>
        </div>
        <div class="risk-item">
          <span class="risk-dot dot-info"></span>
          <div>
            <div class="risk-name">Heuristics</div>
            <div class="risk-note">Fan-in/out, mixers, age of address, risk halos, etc.</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="rxl-footer">
    <span>Â© <span id="year"></span> RiskXLabs</span>
    <span class="version-label" aria-label="version">X-Wallet v1.5</span>
  </footer>

  <!-- What's New Modal -->
  <dialog id="whatsNew" class="modal">
    <form method="dialog" class="modal-card card">
      <header class="modal-header">
        <h3>Whatâ€™s New â€” v1.5</h3>
        <button value="cancel" aria-label="Close" class="icon-btn">âœ•</button>
      </header>
      <div class="modal-body">
        <ul class="whats-list">
          <li>Multi-chain selector with quick-pick pills and multi-select list</li>
          <li>OFAC hard-block pipeline (app/worker consume from local or remote lists)</li>
          <li>Scam cluster baseline â‰¥60; phishing clusters enriched</li>
          <li>Safer defaults, cleaner hand-off to <code>app.js</code>/<code>worker.js</code> via <code>localStorage</code></li>
        </ul>
      </div>
      <footer class="modal-footer">
        <button class="btn btn-primary" value="ok">Got it</button>
      </footer>
    </form>
  </dialog>

  <!-- Minimal inline bootstrapping; main logic remains in app.js -->
  <script>
    (function () {
      const VERSION = "1.5.0";
      const STORAGE_KEY = "xw.selectedNetworks";
      const SUPPORTED = ["ethereum","base","polygon","sepolia","arbitrum","optimism"];

      const byId = (id) => document.getElementById(id);
      const pills = document.querySelectorAll(".pill-select");
      const select = byId("networkSelect");
      const selectAllBtn = byId("selectAll");
      const selectNoneBtn = byId("selectNone");
      const enterBtn = byId("enterBtn");
      const yearEl = byId("year");
      const modal = byId("whatsNew");
      const whatsOpen = byId("whatsNewOpen");
      const toolsBtn = byId("toolsBtn");
      const toolsMenu = byId("toolsMenu");

      yearEl.textContent = new Date().getFullYear();

      // Toggle pill selection
      pills.forEach(p => {
        p.addEventListener("click", () => {
          const pressed = p.getAttribute("aria-pressed") === "true";
          p.setAttribute("aria-pressed", String(!pressed));
          p.classList.toggle("pill-selected", !pressed);
          syncSelectFromPills();
        });
      });

      // Bulk actions
      selectAllBtn.addEventListener("click", () => {
        pills.forEach(p => { p.setAttribute("aria-pressed", "true"); p.classList.add("pill-selected"); });
        syncSelectFromPills();
      });
      selectNoneBtn.addEventListener("click", () => {
        pills.forEach(p => { p.setAttribute("aria-pressed", "false"); p.classList.remove("pill-selected"); });
        syncSelectFromPills();
      });

      // Keep <select> in sync with pills
      function syncSelectFromPills() {
        const chosen = getChosenFromPills();
        Array.from(select.options).forEach(opt => {
          opt.selected = chosen.includes(opt.value);
        });
      }
      function getChosenFromPills() {
        return Array.from(pills)
          .filter(p => p.getAttribute("aria-pressed") === "true")
          .map(p => p.dataset.id)
          .filter(v => SUPPORTED.includes(v));
      }

      // If user changes the select, reflect in pills
      select.addEventListener("change", () => {
        const chosen = Array.from(select.selectedOptions).map(o => o.value);
        pills.forEach(p => {
          const on = chosen.includes(p.dataset.id);
          p.setAttribute("aria-pressed", String(on));
          p.classList.toggle("pill-selected", on);
        });
      });

      // Persist and launch
      enterBtn.addEventListener("click", () => {
        const selected = getChosenFromPills();
        localStorage.setItem(STORAGE_KEY, JSON.stringify(selected));
        localStorage.setItem("xw.version", VERSION);

        // Optional: pass along via query too (helps with debugging)
        const next = "app.html"; // change to your actual entry if different
        const qs = new URLSearchParams({ nets: selected.join(","), v: VERSION });
        window.location.href = `${next}?${qs.toString()}`;
      });

      // Tools dropdown (no framework)
      toolsBtn.addEventListener("click", () => {
        const expanded = toolsBtn.getAttribute("aria-expanded") === "true";
        toolsBtn.setAttribute("aria-expanded", String(!expanded));
        toolsMenu.classList.toggle("open", !expanded);
      });
      document.addEventListener("click", (e) => {
        if (!toolsBtn.contains(e.target) && !toolsMenu.contains(e.target)) {
          toolsBtn.setAttribute("aria-expanded", "false");
          toolsMenu.classList.remove("open");
        }
      });

      // What's New modal
      whatsOpen.addEventListener("click", (e) => {
        e.preventDefault();
        if (typeof modal.showModal === "function") modal.showModal();
        else modal.setAttribute("open", "open");
      });
    })();
  </script>

  <!-- Your main bundle (kept as-is) -->
  <script src="app.js" defer></script>
</body>
</html>
